# 程序更新说明

## 如何更新程序功能

### 步骤 1：修改源代码

1. 打开 `stock_trader.py` 文件
2. 添加或修改功能
3. 保存文件

### 步骤 2：检查依赖

- 如果添加了新功能需要新的 Python 库，更新 `requirements.txt`
- 安装新依赖：`pip install -r requirements.txt`

### 步骤 3：重新打包

运行以下任一命令重新打包：

```bash
# 方法1：使用批处理文件（推荐）
打包.bat

# 方法2：使用Python脚本
python build_exe.py

# 方法3：直接使用PyInstaller
pyinstaller --clean --noconfirm build.spec
```

### 步骤 4：分发新版本

- 新的 exe 文件在 `dist/股票交易助手.exe`
- 将新文件替换旧文件即可

## 版本管理建议

### 方法一：添加版本号到文件名

修改 `build.spec` 或 `build_exe.py` 中的程序名称：

```python
APP_NAME = "股票交易助手_v1.1"  # 更新版本号
```

### 方法二：在程序中显示版本号

在 `stock_trader.py` 中添加版本信息：

```python
VERSION = "1.1.0"

def __init__(self, root):
    self.root = root
    self.root.title(f"股票交易助手 v{VERSION}")
    # ...
```

## 更新检查清单

在重新打包前，检查：

- [ ] 源代码已保存
- [ ] 新功能已测试通过
- [ ] 所有依赖已安装
- [ ] `requirements.txt` 已更新（如有新依赖）
- [ ] `build.spec` 已更新（如有新数据文件需要包含）

## 注意事项

1. **清理旧文件**：打包前可以删除 `build` 和 `dist` 文件夹，确保干净打包

   ```bash
   rmdir /s /q build dist
   ```

2. **保留源代码**：始终保留 `stock_trader.py` 源代码，这样以后可以随时修改和更新

3. **测试新版本**：打包完成后，先测试新 exe 文件，确保功能正常再分发给朋友

4. **备份旧版本**：如果用户已经使用了旧版本，建议保留旧版本备份，以防新版本有问题

5. **数据兼容性**：如果修改了 `watchlist.json` 的数据格式，需要考虑向后兼容

## 快速更新命令

创建一个更新脚本 `更新.bat`：

```batch
@echo off
echo 清理旧文件...
rmdir /s /q build dist 2>nul
echo 开始重新打包...
pyinstaller --clean --noconfirm build.spec
echo 打包完成！
pause
```
